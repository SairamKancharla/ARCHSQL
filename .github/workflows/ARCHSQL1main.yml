jobs:
deploy:
   runs-on: windows-latest
   steps:
    - uses: actions/checkout@v2
    - name: create dacpac
        run:|
          & 'C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\MSBuild\Current\Bin\msbuild.exe' Archdemo.sqlproj /p:Configuration=Release
    - uses: azure/login@v1
        with :
          creds: ${{ secrets.AZURE_CREDENTIALS }}
      - name: Azure SQL Deploy
        uses: Azure/sql-action@v1
        with:
          # Name of the SQL Server
          server-name: 'testdbserver.database.windows.net'
          # The connection string, including authentication information for the Azure SQL Database 
          connection-string: '${{ secrets.AZURE_SQL_CONNECTION_STRING }}'
          # Path to the dacpac file
          dacpac-package: ${{ github.workspace }}\bin\Release\Archdemo.dacpac
          # Additional arguments 
          arguments: '/p:IncludeCompositeObjects=true'   
